# repos.yaml
repos:
- id: /.*/
  allow_custom_workflows: true
  allowed_overrides: [workflow]
  pre_workflow_hooks:
    - run: terragrunt-atlantis-config generate --output atlantis.yaml --autoplan --parallel
  workflow: terragrunt
workflows:
  terragrunt:
    # init:
    #   steps:
    #     # - run: tfenv install && tgenv install && terragrunt init
    #     - run: echo "hello"
    plan:
      steps:
        - run: echo `ls`
        - run: terraform init && ./import_resources.sh
        - run: terragrunt plan -no-color -out $PLANFILE
    apply:
      steps:
      - run: tfenv install && tgenv install && terragrunt apply -no-color $PLANFILE
